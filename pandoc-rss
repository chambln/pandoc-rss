#!/usr/bin/env rc

SUFFIX = .md

printf %s\n > /tmp/pandoc-rss.xml (
	'<item>'
	'<title>$title$</title>'
	'<link>$guid$</link>'
	'<guid>$guid$</guid>'
	'$if(description)$'
	'<description>$description$</description>'
	'$endif$'
	'$if(lang)$'
	'<language>$lang$</language>'
	'$endif$'
	'<pubDate>$date$</pubDate>'
	'</item>'
)

ifs='
'
guid = $1
shift
for (i in $*) {
	id = $^guid^`{ printf $^i | sed 's/\.\w*$//' }
	pandoc --template=/tmp/pandoc-rss.xml -V guid:$^id $^i
}
